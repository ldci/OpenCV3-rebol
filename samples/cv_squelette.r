#! /usr/local/bin/rebolREBOL [	Title:		"OpenCV Tests: Squelette"	Author:		"François Jouen"	Rights:		"Copyright (c) 2012-2016 François Jouen. All rights reserved."	License:     "BSD-3 - https://github.com/dockimbel/Red/blob/master/BSD-3-License.txt"]do %../opencv.rset 'appDir what-dir srcWnd: "Source"dstWnd: "Filtering"picture: to-string to-local-file join appDir "_images/O.png";print "Select a picture";temp: request-file ;picture: to-string to-local-file to-string tempcvNamedWindow srcWnd CV_WINDOW_AUTOSIZEcvNamedWindow dstWnd CV_WINDOW_AUTOSIZEsrc: cvLoadImage picture CV_LOAD_IMAGE_GRAYSCALEsrcS: GetPointerValues src IplImage!w: srcS/widthh: srcS/heightskel: cvCreateImage w h 8 1temp: cvCreateImage w h 8 1eroded: cvCreateImage w h 8 1cvZero skelcvZero tempdst: cvCloneImage srccvShowImage srcWnd srccvShowImage dstWnd dstelement: cvCreateStructuringElementEx 5 5 3 3 CV_SHAPE_ELLIPSE 0m: 100.00_max: pointer 'decimal! m_min: pointer 'decimal! mmax_val: &pointer _maxmin_val: &pointer _maxmin_loc: make struct! cvPoint! [0 0]max_loc: make struct! cvPoint! [0 0]cvThreshold dst dst 127 127 CV_THRESH_BINARY; version 1{until [	;cvDilate dst temp element 1 	;cvErode dst dst element 1	cvMorphologyEx dst temp none element 1 1	cvNot temp temp	cvAnd dst temp temp none	cvOr skel temp skel none	cvErode dst dst element 1	cvMinMaxLoc dst min_val max_val &pointer min_loc &pointer max_loc none ;OK	cvShowImage dstWnd dst	_max/value = 0.0]}; optimisationn: w * huntil [	cvErode dst eroded element 1	;cvDilate eroded temp element 1	;cvSub dst temp temp none	;cvAnd dst temp temp none	;cvOr skel temp skel none	dst: eroded	cvShowImage dstWnd dst	n: cvCountNonZero dst 	print n	cvWaitKey 0	n = 0]cvWaitKey 0free-mem srcfree-mem dstfree-mem skelfree-mem erodedfree-mem tmpfreeDylib