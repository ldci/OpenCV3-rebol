#! /usr/bin/rebolREBOL [	Title:		"OpenCV Tests: Image Conversions with cvCvtColor"	Author:		"François Jouen"	Rights:		"Copyright (c) 2012-2014 François Jouen. All rights reserved."	License:    "BSD-3 - https://github.com/dockimbel/Red/blob/master/BSD-3-License.txt"]do %../opencv.rset 'appDir what-dir bit8: true ; 8 or 32-bit images wName1: "Original Image [a key continue]"wName2: "Modified Image [a key continue]";picture:  to-string to-local-file join appDir "images/lena.tiff"print "Select a picture"temp: request-file picture: to-string to-local-file to-string temp;picture: cvLoadImage picture  CV_LOAD_IMAGE_ANYDEPTH OR CV_LOAD_IMAGE_ANYCOLOR; CV_LOAD_IMAGE_COLOR; CV_LOAD_IMAGE_GRAYSCALE; imgStruct: getPointerValues picture IplImage!src: cvCreateImage imgStruct/width imgStruct/height IPL_DEPTH_32F 3scale: 1 / 255 ; 0.003921568627451cvConvertScale picture src scale 0.0if bit8 [src: cvCloneImage picture src] dst: cvCreateImage imgStruct/width imgStruct/height imgStruct/depth imgStruct/nChannelscvNamedWindow wName1 CV_WINDOW_AUTOSIZEcvNamedWindow wName2 CV_WINDOW_AUTOSIZEcvZero dstcvShowImage wName1 src cvMoveWindow wName1  100 40cvMoveWindow wName2  120 100Print "Playing with cvCvtColor" print ["8-bit image: " bit8];RGB<=>CIE XYZ.Rec 709 with D65 white point (CV_BGR2XYZ, CV_RGB2XYZ, CV_XYZ2BGR, CV_XYZ2RGB): print "RGB<=>CIE XYZ.Rec 709 with D65 white point"cvCvtColor src dst CV_BGR2XYZ cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_RGB2XYZcvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_RGB2XYZ cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_XYZ2BGRcvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_XYZ2RGBcvShowImage wName2 dst cvWaitKey 0; RGB<=>YCrCb JPEG (a.k.a. YCC) CV_BGR2YCrCb, CV_RGB2YCrCb, CV_YCrCb2BGR, CV_YCrCb2RGBprint "RGB<=>YCrCb JPEG (a.k.a. YCC) "cvCvtColor src dst CV_BGR2YCrCb cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_RGB2YCrCbcvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_YCrCb2BGR cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_YCrCb2RGBcvShowImage wName2 dst cvWaitKey 0;RGB<=>HSV (CV_BGR2HSV, CV_RGB2HSV, CV_HSV2BGR, CV_HSV2RGB) print "RGB<=>HSV"cvCvtColor src dst CV_BGR2HSV cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_RGB2HSVcvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_HSV2BGR cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_HSV2RGBcvShowImage wName2 dst cvWaitKey 0;RGB<=>HLS (CV_BGR2HLS, CV_RGB2HLS, CV_HLS2BGR, CV_HLS2RGB) print "RGB<=>HLS"cvCvtColor src dst CV_BGR2HLS cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_RGB2HLScvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_HLS2BGR cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_HLS2RGBcvShowImage wName2 dst cvWaitKey 0;RGB<=>CIE L*a*b* (CV_BGR2Lab, CV_RGB2Lab, CV_Lab2BGR, CV_Lab2RGB) print "RGB<=>CIE L*a*b*"cvCvtColor src dst CV_BGR2Lab cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_RGB2LabcvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_Lab2BGR cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_Lab2RGBcvShowImage wName2 dst cvWaitKey 0;RGB<=>CIE L*u*v* (CV_BGR2Luv, CV_RGB2Luv, CV_Luv2BGR, CV_Luv2RGB) print "RGB<=>CIE L*u*v*"cvCvtColor src dst CV_BGR2Luv cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_RGB2LuvcvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_Luv2BGR cvShowImage wName2 dst cvWaitKey 0cvCvtColor src dst CV_Luv2RGBcvShowImage wName2 dst cvWaitKey 0;Bayer=>RGB (CV_BayerBG2BGR, CV_BayerGB2BGR, CV_BayerRG2BGR, CV_BayerGR2BGR, CV_BayerBG2RGB, CV_BayerGB2RGB, CV_BayerRG2RGB, CV_BayerGR2RGB) ; for cmos and CCDprint "All tests done. Hit a key!"cvWaitKey 0cvDestroyAllWindows ; release image pointerfree-mem picture free-mem src free-mem dst freeDylib